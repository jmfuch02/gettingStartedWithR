---
title       : Five Things You Should Be Doing in R
subtitle    : An Introduction
author      : Jason Fuchs
job         : Sr. Product Engineer, Research and Development
framework   : io2012        # {io2012, html5slides, shower, dzslides, ...}
highlighter : highlight.js  # {highlight.js, prettify, highlight}
hitheme     : tomorrow      # 
widgets     : []            # {mathjax, quiz, bootstrap}
mode        : selfcontained # {standalone, draft}
knit        : slidify::knit2slides
---

## Introduction: Data Analysis

"Solve this problem... Answer this question..."

- Load the data
- Clean it
- Graph it
- Change something
- Send it to 'production'

--- .class1

## Problems

> - Acquisition, cleaning, reporting all need separate tools
> - Data and analysis live together in the same file
> - Updating data is hard
> - Describing what you did to someone else is nearly impossible

---

## Why R?

* It's free
* It has a very nice development environment: Rstudio - www.rstudio.com
* There is an active community of developers and support
* There is a wide variety of packages, which are easy to install

---

## Getting R

R - https://cran.r-project.org/

RStudio - https://www.rstudio.com/products/rstudio/download/

---

## Basics

* Use the <- operator to assign
* Don't use ; at the end of lines
* You don't have to declare a specific type

```{r}
x <- 1
x

y <- c(2, "red", 4)
y
```

---

## Basics: Data Frames

```{r}
d <- c(1,2,3,4)
e <- c("red", "white", "red", NA)
f <- c(TRUE,TRUE,TRUE,FALSE)
mydata <- data.frame(d,e,f)
names(mydata) <- c("ID","Color","Passed") # variable names
print(mydata)
```

http://www.statmethods.net/input/datatypes.html

---

## Basics: Data Frames

```{r}
print(mydata)
mydata[3,2]
```

---

## Basics: Factors

```{r}
# variable gender with 20 "male" entries and 30 "female" entries 
gender <- c(rep("male",20), rep("female", 30)) 
gender <- factor(gender) 
# stores gender as 20 1s and 30 2s and associates
# 1=female, 2=male internally (alphabetically)
summary(gender)
str(gender)
```

http://www.statmethods.net/input/datatypes.html

---

## 1. Getting data from a database or website

```{r}
fileUrl <- "http://data.baltimorecity.gov/api/views/dz54-2aru/rows.csv?accessType=DOWNLOAD"
download.file(fileUrl,destfile="./data/cameras.csv")
list.files("./data")
dateDownloaded <- date()
dateDownloaded
```

https://github.com/rdpeng/courses/tree/master/03_GettingData

---

## 1. Getting data from a database or website

```{r}
cameraData <- read.table("./data/cameras.csv",sep=",",header=TRUE)
head(cameraData)
```

---

## 1. Getting data from a database or website

Database connections  
  
[PostgreSQL - "RPostgreSQL"](https://cran.r-project.org/web/packages/RPostgreSQL/index.html)

[Oracle - "ROracle"](https://cran.r-project.org/web/packages/ROracle/index.html)

[MySQL - "RMySQL"](https://cran.r-project.org/web/packages/RMySQL/index.html)

---

## 1. Getting data from a database or website

PostgreSQL example
  
```{r, eval=FALSE}
drv <- dbDriver("PostgreSQL")                       # Load driver
con <- dbConnect(drv, dbname="tempdb")              # Connect
rs <- dbSendQuery(con,"select * from TableName")    # Run a query
fetch(rs,n=-1)                                      # Return all elements
dbDisconnect(con)                                   # Disconnect
dbUnloadDriver(drv)                                 # Unload driver
```

https://code.google.com/p/rpostgresql/

---

## 2. Cleaning Data

```{r}
fileUrl <- "http://data.baltimorecity.gov/api/views/k5ry-ef3g/rows.csv?accessType=DOWNLOAD"
download.file(fileUrl,destfile="./data/restaurants.csv")
restData <- read.csv("./data/restaurants.csv")
```

[Source: JHU-DS](https://github.com/rdpeng/courses/blob/master/03_GettingData/03_02_summarizingData/index.Rmd)

---

## 2. Cleaning Data

Summarizing data

```{r}
str(restData)
```

[Source: JHU-DS](https://github.com/rdpeng/courses/blob/master/03_GettingData/03_02_summarizingData/index.Rmd)

---

## 2. Cleaning Data

Finding missing values

```{r}
sum(is.na(restData$councilDistrict))
all(restData$zipCode > 0)
```

[Source: JHU-DS](https://github.com/rdpeng/courses/blob/master/03_GettingData/03_02_summarizingData/index.Rmd)

---

## 2. Cleaning Data

Finding specific values

```{r}
table(restData$zipCode %in% c("21212"))
table(restData$zipCode %in% c("21212","21213"))
```

[Source: JHU-DS](https://github.com/rdpeng/courses/blob/master/03_GettingData/03_02_summarizingData/index.Rmd)

---

## 3. Making charts and graphs

Loading `ggplot2`

```{r, eval=FALSE}
install.packages("ggplot2")
```

```{r, warning=FALSE, error=FALSE, message=FALSE}
library(ggplot2)
```

http://docs.ggplot2.org/current/

---

## 3. Making charts and graphs

Example dataset `mpg`

```{r, warning=FALSE, error=FALSE, message=FALSE}
str(mpg)
```

[Source: JHU-DS](https://github.com/rdpeng/courses/blob/master/04_ExploratoryAnalysis/ggplot2/ggplot2_p1.Rmd)

---

## 3. Making charts and graphs

```{r, warning=FALSE, error=FALSE, message=FALSE, fig.height=5, fig.width=12}
qplot(displ, hwy, data = mpg)
```

[Source: JHU-DS](https://github.com/rdpeng/courses/blob/master/04_ExploratoryAnalysis/ggplot2/ggplot2_p1.Rmd)

---

## 3. Making charts and graphs

```{r, warning=FALSE, error=FALSE, message=FALSE, fig.height=5, fig.width=12}
qplot(displ, hwy, data = mpg, color = drv)
```

[Source: JHU-DS](https://github.com/rdpeng/courses/blob/master/04_ExploratoryAnalysis/ggplot2/ggplot2_p1.Rmd)

---

## 3. Making charts and graphs

```{r, warning=FALSE, error=FALSE, message=FALSE, fig.height=5, fig.width=12}
qplot(displ, hwy, data = mpg, geom = c("point", "smooth"))
```

[Source: JHU-DS](https://github.com/rdpeng/courses/blob/master/04_ExploratoryAnalysis/ggplot2/ggplot2_p1.Rmd)

---

## 3. Making charts and graphs

```{r, warning=FALSE, error=FALSE, message=FALSE, fig.height=5, fig.width=12}
qplot(hwy, data = mpg, fill = drv)
```

[Source: JHU-DS](https://github.com/rdpeng/courses/blob/master/04_ExploratoryAnalysis/ggplot2/ggplot2_p1.Rmd)

---

## 3. Making charts and graphs

```{r, warning=FALSE, error=FALSE, message=FALSE, fig.height=5, fig.width=12}
qplot(displ, hwy, data = mpg, facets = . ~ drv)
```

[Source: JHU-DS](https://github.com/rdpeng/courses/blob/master/04_ExploratoryAnalysis/ggplot2/ggplot2_p1.Rmd)

---

## 3. Making charts and graphs

```{r, warning=FALSE, error=FALSE, message=FALSE, fig.height=5, fig.width=12}
qplot(hwy, data = mpg, facets = drv ~ ., binwidth = 2)
```

[Source: JHU-DS](https://github.com/rdpeng/courses/blob/master/04_ExploratoryAnalysis/ggplot2/ggplot2_p1.Rmd)

---

## 4. Interacting with data

`manipulate` function

```{r, eval=FALSE}
library(manipulate)
manipulate(plot(1:x), x = slider(1, 100))
```

[Documentation](https://support.rstudio.com/hc/en-us/articles/200551906-Interactive-Plotting-with-Manipulate)

---

## 4. Interacting with data

Another example

```{r, eval=FALSE}
library(manipulate)
library(HistData)
data(Galton)
myHist <- function(mu){
    hist(Galton$child,col="blue",breaks=100)
    lines(c(mu, mu), c(0, 150),col="red",lwd=5)
    mse <- mean((Galton$child - mu)^2)
    text(63, 150, paste("mu = ", mu))
    text(63, 140, paste("MSE = ", round(mse, 2)))
}
manipulate(myHist(mu), mu = slider(62, 74, step = 0.5))
```

[Source: JHU-DS](https://github.com/rdpeng/courses/blob/master/09_DevelopingDataProducts/manipulate/index.Rmd)

---

## 5. Creating presentations and reports

* Presentations: You're looking at one
* Reports

http://rmarkdown.rstudio.com/

---

## Resources

[Swirl](http://swirlstats.com/)

[Coursera Data Science - Johns Hopkins](https://www.coursera.org/specialization/jhudatascience/1)

[Course Material](https://github.com/rdpeng/courses)

[Shiny Gallery](http://shiny.rstudio.com/gallery/)

---
